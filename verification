from Crypto.Util.number import inverse
from Crypto.Util.number import bytes_to_long
from Crypto.Util.number import long_to_bytes

prime1 = 634731455310475127289943851811790665560224271618846972703286196017000896986513107848145591
prime2 = 184407134653793849556162060753786073114149907528168652960488068595350605238125030861663291
e = 65537

n = prime1 * prime2
print("n value is :- ",n)
PHI=(prime1-1)*(prime2-1)
d = inverse(e, PHI)

print("\nd value is :- ",d)


original_message1 = bytes_to_long(b'I have changed the server password to Qy21@#qa21388!&')
print("\noriginal message1 is :- ",original_message1)

Alice_Sign_m1 = pow(original_message1,d, n)
print("\nAlice signed m1 :- ",Alice_Sign_m1)

original_message2 = bytes_to_long(b'I have changed the server password to Hxs93wa@!!VX663')
print("\noriginal message2 is :- ",original_message2)

Alice_Sign_m2 = pow(original_message2,d, n)
print("\nAlice signed m2 :- ",Alice_Sign_m2)

multiplication_of_m1_m2 = (original_message1*original_message2)%n
multiplication_of_s1_s2 = (Alice_Sign_m1*Alice_Sign_m2)%n

print("\nmultiplication of m1 and m2 is :- ",multiplication_of_m1_m2)

print("\nmultiplication of s1 and s2 is :- ",multiplication_of_s1_s2)

verified_signature = pow(multiplication_of_s1_s2,e, n)

print("\nverified signature is :- ", verified_signature)








n value is :-  117049008948437320003644310433913871466679673946312665409089800638842128197343496986242793301356588877558598919795988971886120196861572468452552959952341979016326424313788188199981

d value is :-  20187145400982453087587036953698345807526746030718099045103407489217275356128195468750511671674169426688932943206416735897507352315104547235936787291160847695385933578495598734373

original message1 is :-  12375237272836394206396747128432533029007126742537087510475476626745402122124853781867603494742764643873790419149769716478255398

Alice signed m1 :-  83451530133974139903592821459514526753368348701134190895283111147781609596628319770390540226386348897856179207827296815299360954587019361602745333817541774451741569372088483043621

original message2 is :-  12375237272836394206396747128432533029007126742537087510475476626745402122124853781867603494696018842028497170174238004811806259

Alice signed m2 :-  86171673130397891103204558557266798556896421019181114807399262220675114304396466395413392641445776918550732543874569286681242959516743670940002285956671739358377121487288419577524

multiplication of m1 and m2 is :-  61455320141831863288258737754556736381594090926573244151413136492938979160401691682282956484879706098276095067796961528118772751804386020187363757270943983127402676011466988354444

multiplication of s1 and s2 is :-  21265422983957326046962278720129893379426493071596534717995952477041934904244222725681773101958739817217993929309213102114160057702734512354396346845444355036063672246386054883686

verified signature is :-  61455320141831863288258737754556736381594090926573244151413136492938979160401691682282956484879706098276095067796961528118772751804386020187363757270943983127402676011466988354444
